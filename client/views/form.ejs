<p><%= data[0] %></p>
<p><%= data[1] %></p>
<form action="/check" method="POST" id="emailForm">
  <div class="form-group">
    <label for="InputEmail">Email address</label>
    <input
      type="email"
      name="email"
      class="form-control"
      id="InputEmail"
      aria-describedby="emailHelp"
      required
    />
    <small id="emailHelp" class="form-text text-muted"
      >We'll never share your email with anyone else.</small
    >
  </div>
  <!-- <div class="form-group">
    <label for="productLink">Enter you product link here</label>
    <input
      class="form-control"
      id="productLink"
      type="text"
      name="link"
      required
    />
  </div> -->
  <div class="form-group">
    <label for="price_input">Enter your price</label>
    <input
      class="form-control"
      id="price_input"
      type="text"
      name="price"
      required
    />
  </div>
  <div
    name="captcha"
    class="g-recaptcha form-group"
    data-sitekey="6LfuYP8UAAAAACRY91-zROneWqdI4QPoV1L7jvyR"
  ></div>
  <br />
  <button class="btn btn-primary">
    Submit
  </button>
</form>
<script>
  document.querySelector("#emailForm").addEventListener("submit", (e) => {
    e.preventDefault();
    const email = document.querySelector("#InputEmail").value;
    const price = document.querySelector("#price_input").value;
    const captcha = document.querySelector("#g-recaptcha-response").value;
    fetch("/check", {
      method: "POST",
      headers: {
        "Content-type": "application/json",
      },
      body: JSON.stringify({
        email,
        price,
        captcha,
      }),
    })
      .then((res) => res.json())
      .then((data) => {
        console.log(data);
        alert(data.msg);
        if (data.success) return (location.href = "result");
      });
  });
</script>
